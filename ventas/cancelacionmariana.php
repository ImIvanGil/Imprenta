<?php 
//El sistema no maneja grupos de cancelacion
ini_set("display_errors","On");
//$_REQUEST['UUID'];
$UUID= 'C88D132D-29A7-4159-8590-763D3D7E09C3';
$listaCFDI=array( 'string' => $UUID);
$certificadoPKCS12_Base64 = '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
COAe/CilVjDSAgIIAA==';//file_get_contents("config/CFDI/eleon/Leonme71.pfx.pem"); 
/*************************CANCELACION****************/
/*****************Llamamos al Timbrado************************/

require_once('../lib/nusoap.php');

$datos=array
(
'usuario' =>'IGC061204E47',
'password' =>'R@6Tdn11KX=',
'RFCEmisor' => 'IGC061204E47',
'listaCFDI' => $listaCFDI,
'certificadoPKCS12_Base64' => $certificadoPKCS12_Base64,
'passwordPKCS12' => 'Cpimpresos2011'
);

$oSoapClient = new nusoap_client('https://www.foliosdigitalespac.com/ws-folios/WS-TFD.asmx?WSDL',$datos);

$Cdatos=array
(

'usuario' =>'IGC061204E47',
'password' =>'R@6Tdn11KX=',
'RFCEmisor' => 'IGC061204E47',
'listaCFDI' => $listaCFDI,
'certificadoPKCS12_Base64' => $certificadoPKCS12_Base64,
'passwordPKCS12' => 'Cpimpresos2011'
);
$funcion = 'CancelarCFDI';
$respuesta = $oSoapClient->call($funcion, $Cdatos); 

if (!$error = $oSoapClient->getError())
{

$estatus=$respuesta['CancelarCFDIResult']['string'][0];
$sta=$respuesta['CancelarCFDIResult']['string'][1];
$AcuseXML= end($respuesta['CancelarCFDIResult']['string']);
echo "el estatus es: ".$sta."<br>";
}
else{
echo "ERROR:".print_r ($error);
exit;
}
print_r ($respuesta);
//echo "estatus".$estatus;
//echo "acuse".$AcuseXML;
/*****************************************/
/*****************************************/
/*
$AcuseXML=simplexml_load_string($AcuseXML);//utf8_encode(
$AcXML=dom_import_simplexml($AcuseXML);
$ac = new DOMDocument('1.0', 'utf-8');;
$AcXML = $ac -> importNode ( $AcXML , true ); 
$AcXML = $ac -> appendChild ( $AcXML );
//echo $dom2->saveXML();
$ac->save("config/CFDI/".$LIBELE."/PDFyXML/Cancelacion_".$UUID.".xml");
*/
?>